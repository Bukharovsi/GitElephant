

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Welcome to GitElephant’s documentation! &mdash; GitElephant 0.6.2 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.6.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="GitElephant 0.6.2 documentation" href="#" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="#">GitElephant 0.6.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="welcome-to-gitelephant-s-documentation">
<h1>Welcome to GitElephant&#8217;s documentation!<a class="headerlink" href="#welcome-to-gitelephant-s-documentation" title="Permalink to this headline">¶</a></h1>
<p>Contents:</p>
<div class="toctree-wrapper compound">
<ul class="simple">
</ul>
</div>
<img alt="http://stillmaintained.com/matteosister/GitElephant.png" src="http://stillmaintained.com/matteosister/GitElephant.png" />
<img alt="https://secure.travis-ci.org/matteosister/GitElephant.png" src="https://secure.travis-ci.org/matteosister/GitElephant.png" />
<p>GitElephant is an abstraction layer to manage your git repositories with php</p>
<p>Watch a <a class="reference external" href="http://gitelephant.cypresslab.net/">simple live example</a> of what you can do with GitElephant, <a class="reference external" href="https://github.com/matteosister/GitElephantBundle">GitElephantBundle</a>, Symfony2 and a git repository...</p>
<p><a class="reference external" href="https://github.com/matteosister/GitElephantDemoBundle/">Download the demo bundle code</a> used in the live example</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>php &gt;= 5.3</li>
<li><a href="#id1"><span class="problematic" id="id2">*</span></a>nix system with git installed</li>
</ul>
<p>I work on an ubuntu box, but the lib should work well with every unix system. I don&#8217;t have a windows installation to test...if someone want to help...</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p><strong>composer</strong></p>
<p>To install GitElephant with composer you simply need to create a <em>composer.json</em> in your project root and add:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;require&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;cypresslab/gitelephant&quot;</span><span class="p">:</span> <span class="s">&quot;&gt;=0.6.0&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Then run:</p>
<div class="highlight-python"><pre>$ wget -nc http://getcomposer.org/composer.phar
$ php composer.phar install</pre>
</div>
<p>You have now GitElephant installed in <em>vendor/cypresslab/gitelephant</em></p>
<p>And an handy autoload file to include in you project in <em>vendor/.composer/autoload.php</em></p>
<p><strong>pear</strong></p>
<dl class="docutils">
<dt>Add the Cypresslab channel::</dt>
<dd>$ pear channel-discover pear.cypresslab.net</dd>
</dl>
<p>And install the package. <em>By now GitElephant is in alpha state. So remember the -alpha in the library name</em>:</p>
<div class="highlight-python"><pre>$ pear install cypresslab/GitElephant-alpha</pre>
</div>
<p>On [Cypresslab pear channel homepage](<a class="reference external" href="http://pear.cypresslab.net/">http://pear.cypresslab.net/</a>) you can find other useful information</p>
</div>
<div class="section" id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<p>The library is fully tested with PHPUnit for unit tests, and Behat for BDD. To run tests you need these (awesome) libraries installed on your system.</p>
<p>Go to the base library folder and run the test suites:</p>
<div class="highlight-python"><pre>$ phpunit # phpunit test suite
$ behat # behat test suite</pre>
</div>
</div>
<div class="section" id="code-style">
<h2>Code style<a class="headerlink" href="#code-style" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>GitElephant follows the <a class="reference external" href="https://github.com/opensky/Symfony2-coding-standard">Symfony2 Coding Standard</a></li>
<li>I&#8217;m using <a class="reference external" href="https://github.com/nvie/gitflow">gitflow</a></li>
</ul>
</div>
<div class="section" id="how-to-use">
<h2>How to use<a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><pre>&lt;?php

use GitElephant\Repository;
$repo = new Repository('/path/to/git/repository');</pre>
</div>
<p>the <em>Repository</em> class is the main class where you can find every method you need...</p>
<p><strong>Read repository</strong>:</p>
<div class="highlight-python"><pre>&lt;?php
// get the current status
// returns an array of lines of the status message
$repo-&gt;getStatus();

// branches
// return an array of TreeBranch objects
$repo-&gt;getBranches();
// return the TreeBranch instance of the current checked out branch
$repo-&gt;getMainBranch();
// return a TreeBranch instance by its name
$repo-&gt;getBranch('master');

// tags
// array of TreeTag instances
$repo-&gt;getTags();
// a TreeTag instance by name
$repo-&gt;getTag('v1.0');

// commit
// get a Commit instance of the current HEAD
$repo-&gt;getCommit();
// get a Commit instance for a tag
$repo-&gt;getCommit('v1.0');
// sha (follow git standard to format the sha)
$repo-&gt;getCommit('1ac370d');

// Log contains a collection of commit objects
// syntax: getLog(&lt;tree-ish&gt;, limit = 15, offset = null)
$log = $repo-&gt;getLog();
$log = $repo-&gt;getLog('master', 5);
$log = $repo-&gt;getLog('v0.1', 5, 10);

// countable
$log-&gt;count();
count($log);

// iterable
foreach ($log as $commit) {
    echo $commit-&gt;getMessage();
}</pre>
</div>
<p><strong>Manage repository</strong></p>
<p>You could also use GitElephant to manage your git repositories via PHP.</p>
<p>Your web server user (like www-data) needs to have access to the folder of the git repository:</p>
<div class="highlight-python"><pre>&lt;?php
// init
$repo-&gt;init();
// or clone
$repo-&gt;cloneFrom("git://github.com/matteosister/GitElephant.git");

// stage changes
$repo-&gt;stage('file1.php');
$repo-&gt;stage(); // stage all

// commit
$repo-&gt;commit('my first commit');
// commit and stage every pending changes in the working tree
$repo-&gt;commit('my first commit', true);

// checkout a tag
$repo-&gt;checkout($this-&gt;getCommit('v1.0'));
// checkout master
$repo-&gt;checkout('master');

// manage branches
// create a develop branch from master
$repo-&gt;createBranch('develop', 'master');
// create a develop branch from current checked out branch
$repo-&gt;createBranch('develop');
// delete the develop branch
$repo-&gt;deleteBranch('develop');

// manage tags
// create  a tag named v1.0 from master with the given tag message
$repo-&gt;createTag('v1.0', 'master', 'my first release!');
// create  a tag named v1.0 from the current checked out branch with the given tag message
$repo-&gt;createTag('v1.0', null, 'my first release!');
// create a tag from a Commit object
$repo-&gt;createTag($repo-&gt;getCommit());</pre>
</div>
</div>
<div class="section" id="a-versioned-tree-of-files">
<h2>A versioned tree of files<a class="headerlink" href="#a-versioned-tree-of-files" title="Permalink to this headline">¶</a></h2>
<p>A git repository is a tree structure versioned in time. So if you need to represent a repository in a, let&#8217;s say, web browser, you will need
a tree representation of the repository, at a given point in history.</p>
<p><strong>Tree class</strong>:</p>
<div class="highlight-python"><pre>&lt;?php
// retrieve the actual *HEAD* tree
$tree = $repo-&gt;getTree();
// retrieve a tree for a given commit
$tree = $repo-&gt;getTree($repo-&gt;getCommit('1ac370d'));
// retrieve a tree for a given path
$tree = $repo-&gt;getTree('master', 'lib/vendor');</pre>
</div>
<p>The Tree class implements <em>ArrayAccess</em>, <em>Countable</em> and <em>Iterator</em> interfaces.</p>
<p>You can use it as an array of git objects:</p>
<div class="highlight-python"><pre>&lt;?php
foreach ($tree as $treeObject) {
    echo $treeObject;
}</pre>
</div>
<p>A TreeObject instance is a php representation of a node in a git tree:</p>
<div class="highlight-python"><pre>&lt;?php
echo $treeObject; // the name of the object (folder, file or link)
$treeObject-&gt;getType(); // a class constanf of TreeObject::TYPE_BLOB, TreeObject::TYPE_TREE and TreeObject::TYPE_LINK
$treeObject-&gt;getSha();
$treeObject-&gt;getSize();
$treeObject-&gt;getName();
$treeObject-&gt;getSize();
$treeObject-&gt;getPath();</pre>
</div>
<p>You can also pass a tree object to the repository to get its subtree:</p>
<div class="highlight-python"><pre>&lt;?php
$subtree = $repo-&gt;getTree('master', $treeObject);</pre>
</div>
</div>
<div class="section" id="diffs">
<h2>Diffs<a class="headerlink" href="#diffs" title="Permalink to this headline">¶</a></h2>
<p>If you want to check a Diff between two commits the Diff class comes in:</p>
<div class="highlight-python"><pre>&lt;?php
// get the diff between the given commit and it parent
$diff = $repo-&gt;getDiff($repo-&gt;getCommit());
// get the diff between two commits
$diff = $repo-&gt;getDiff($repo-&gt;getCommit('1ac370d'), $repo-&gt;getCommit('8fb7281'));
// same as before for a given path
$diff = $repo-&gt;getDiff($repo-&gt;getCommit('1ac370d'), $repo-&gt;getCommit('8fb7281'), 'lib/vendor');
// or even pass a TreeObject
$diff = $repo-&gt;getDiff($repo-&gt;getCommit('1ac370d'), $repo-&gt;getCommit('8fb7281'), $treeObject);</pre>
</div>
<p>The Diff class implements <em>ArrayAccess</em>, <em>Countable</em> and <em>Iterator</em> interfaces</p>
<p>You can iterate over DiffObject:</p>
<div class="highlight-python"><pre>&lt;?php
foreach ($diff as $diffObject) {
    // mode is a constant of the DiffObject class
    // DiffObject::MODE_INDEX an index change
    // DiffObject::MODE_MODE a mode change
    // DiffObject::MODE_NEW_FILE a new file change
    // DiffObject::MODE_DELETED_FILE a deleted file change
    echo $diffObject-&gt;getMode();
}</pre>
</div>
<p>A DiffObject is a class that implements <em>ArrayAccess</em>, <em>Countable</em> and <em>Iterator</em> interfaces.</p>
<p>It represent a file, folder or submodule changed in the diff</p>
<p>Every DiffObject can have multiple chunks of changes. For example &#8220;added 3 lines at line 20&#8221; and &#8220;modified 4 lines at line 560&#8221;</p>
<p>So you can iterate over DiffObject to get DiffChunks. DiffChunks are the last steps of the diff iteration.</p>
<p>They are a collection of DiffChunkLine Objects:</p>
<div class="highlight-python"><pre>&lt;?php
foreach ($diffObject as $diffChunk) {
    if (count($diffChunk) &gt; 0) {
        echo "change detected from line ".$diffChunk-&gt;getDestStartLine()." to ".$diffChunk-&gt;getDestEndLine();
        foreach ($diffChunk as $diffChunkLine) {
            echo $diffChunkLine; // output the line content
        }
    }
}</pre>
</div>
<p>This is just an example of what the Diff class can do. Run the diff behat test suite for other nice things:</p>
<div class="highlight-python"><pre>$ behat features/diff.feature</pre>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference internal" href="py-modindex.html"><em>Module Index</em></a></li>
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Welcome to GitElephant&#8217;s documentation!</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#testing">Testing</a></li>
<li><a class="reference internal" href="#code-style">Code style</a></li>
<li><a class="reference internal" href="#how-to-use">How to use</a></li>
<li><a class="reference internal" href="#a-versioned-tree-of-files">A versioned tree of files</a></li>
<li><a class="reference internal" href="#diffs">Diffs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="#">GitElephant 0.6.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Matteo Giachino.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>